\documentclass[a4paper,12pt]{article}
\usepackage{amsmath}
\usepackage{amssymb,amsthm,graphicx}
\usepackage{titlesec}
\usepackage{textcomp}
\usepackage{enumitem}
\usepackage{color}
\usepackage{epsfig}
\usepackage{graphics}
\usepackage{pdfpages}
\usepackage{subcaption}
\usepackage[font=small]{caption}
\usepackage[hang,flushmargin]{footmisc} 
\usepackage{float}
\usepackage{rotating,tabularx}
\usepackage{booktabs}
\usepackage[mathscr]{euscript}
\usepackage{natbib}
\usepackage{setspace}
\usepackage{mathrsfs}
\usepackage[official]{eurosym}
\usepackage[left=2.8cm,right=2.8cm,bottom=2.8cm,top=2.5cm]{geometry}

\setcounter{secnumdepth}{4}
\renewcommand{\baselinestretch}{1.2}
\parindent0pt

\input{macros}



\begin{document}



\begin{center} 
{\large \bf Revision of the paper} \\[0.1cm]
{\large \bf ``Multiscale inference and long-run variance estimation} \\[0.1cm]
{\large \bf in nonparametric regression with time series errors''} 
\end{center}
\vspace{7pt}



First of all, we would like to thank the editor, the associate editor and the reviewers for their many comments and suggestions which were very helpful in improving the paper. In the revision, we have addressed all comments and have rewritten the paper accordingly. Please find our point-by-point responses below. 
%Since the revised paper includes additional material as requested by the referees (e.g. ??), it is a bit longer than the original submission. However, we are of course happy and willing to reduce the length of the paper by shifting parts of it into the online supplement if this is needed. 
Before we reply to the specific comments of the referees, we summarize the major changes in the revision.
\vspace{10pt}


\textbf{Generalization of the theoretical results.} We have extended the theoretical results as suggested by Referee 1:
\begin{enumerate}[label=(\roman*), leftmargin=0.8cm]

\item We have derived the following consistency result in addition to Proposition 3.3: Let the significance level $\alpha = \alpha_T \in (0,1)$ depend on the sample size $T$. If $\alpha_T \rightarrow 0$, then $\mathbb{P}({E}_T^{\ell}) \rightarrow 1$. 
%We provide a generalization of Proposition 3.3 which shows that $\mathbb{P}({E}_T^{\ell}) = (1 - \alpha_T) + o(1)$ for any sequence $\{\alpha_T\}$ of significance levels $\alpha_T \in (0,1)$. In particular, for $\alpha_T \rightarrow 0$, we get the consistency result that $\mathbb{P}({E}_T^{\ell}) \rightarrow 1$. 

\item We have generalized our estimator of the long-run error variance. The estimation procedure is shown to be valid not only for AR($p$) processes of known finite order $p$ but for any stationary error process $\{\varepsilon_t\}$ with an AR($\infty$) representation. This greatly extends the applicability of the estimator. 
\end{enumerate}
\vspace{3pt}


\textbf{Comparison to SiZer.} As requested by the Associate Editor, we give a clear account of the main contributions and innovations of our paper relative to the SiZer approach in the revision. Please see the new Section ?? for the details. In what follows, we give a slightly rephrased and condensed version of the new Section ??. 


Informally speaking, both our approach and SiZer for dependent data (dependent SiZer for short) are methods to test for local increases/decreases of a nonparametric trend function $m$. The formal problem is to test the hypothesis
\[ H_0(u,h): \text{The trend } m \text{ is constant on the time interval } [u-h,u+h] \]
simultaneously for a large number of different time intervals $[u-h,u+h]$, in particular, for all intervals with $u \in I$ and $h \in H$, where $I$ is the set of locations and $H$ the set of bandwidths or scales $H$ under consideration. 


Let $s_T(u,h)$ be the SiZer statistic to test $H_0(u,h)$, which corresponds to the statistic $\widehat{\psi}_T(u,h)$ in our approach and which is properly defined in Section ??. There are two versions of dependent SiZer: 
\begin{enumerate}[label=(\alph*), leftmargin=0.8cm]

\item The global version aggegrates the individual statistics $s_T(u,h)$ into the overall statistic $S_T = \max_{h \in H} S_T(h)$, where $S_T(h) = \max_{u \in I} |s_T(u,h)|$. The statistic $S_T$ is the counterpart to the multiscale statistic $\widehat{\Psi}_T$ in our approach. 

\item The row-wise SiZer version considers each scale $h \in H$ separately. In particular, for each bandwidth $h \in H$, a test is carried out based on the statistic $S_T(h)$. 
%A row-wise analogue of our approach would be obtained by carrying out a test for each scale $h \in H$ separately based on the statistic $\widehat{\Psi}_T(h) = \max_{u \in I} |\widehat{\psi}_T(u,h)/\widehat{\sigma}|$. (Note that we can drop the correction term $\lambda(h)$ in this case as it is a fixed constant if only a single bandwidth $h$ is taken into account.)

\end{enumerate}
In practice, SiZer is commonly implemented in its row-wise form. The main reason is that it has more power than the global version by construction. However, this gain of power comes at a cost: Row-wise SiZer carries out a test \textit{separately} for each scale $h \in H$, thus ignoring the simultaneous test problem across scales $h$. Hence, it is not a rigorous level-$\alpha$-test of the overall null hypothesis $H_0$. For this reason, we focus on global SiZer in what follows. 


Even though related, our methods and theory are markedly different from those of the SiZer approach:
\begin{enumerate}[label=(\roman*), leftmargin=0.8cm]

\item Theory for SiZer is derived under the assumption that the set of bandwidths $H$ is a compact subset of $(0,1)$. As already pointed out in \cite{ChaudhuriMarron2000}, this is a quite substantial/severe restriction: Only bandwidths $h$ are taken into account that remain bounded away from zero as the sample size $T$ grows. Bandwidths $h$ that converge to zero as $T$ increases are excluded.  As \cite{ChaudhuriMarron2000} put it (on p.420):
\vspace{0.15cm}

\begin{spacing}{1.0}
{\small \textit{Note that all the weak convergence results in this section have been established under the assumption that both $H$ and $I$ are fixed compact subintervals of $(0,\infty)$ and $(-\infty,\infty)$ respectively. Compactness of the set $H \times I$ enables us to exploit standard results on weak convergence of a sequence of probability measures on a space of continuous functions defined on a common compact metric space. However, conventional asymptotics for nonparametric curve estimates allows the smoothing parameter $h$ to shrink with growing sample size. There frequently one assumes that $h_n$ is of the order $n^{-\gamma}$ for some appropriate choice of $0 < \gamma < 1$ so that the estimate $\hat{f}_{h_n}(x)$ converges to the ``true function'' $f(x)$ at an ``optimal rate''. This makes one wonder about the asymptotic behaviour of the empirical scale space surface when $h$ varies in $H_n = [a n^{-\gamma},b]$, where $a,b > 0$ are fixed constants. Extension of our weak convergence results along that direction will be quite interesting, and we leave it as a challenging open problem here.} }
\end{spacing} 
\vspace{0.2cm}

The theory of our paper allows to deal with this problem. In particular, it allows to simultaneously consider scales $h$ that remain bounded away from zero and scales $h = h_T$ that converge to zero at various different rates $T^{-\gamma}$. To achieve this, we come up with a proof strategy which is very different from that in the SiZer literature:  As proven in \cite{ChaudhuriMarron2000} for the i.i.d.\ case and in \cite{ParkHannigKang2009} for the dependent data case, $S_T$ weakly converges to some limit process $S$ under the overall null hypothesis $H_0$. This is the central technical result on which the theoretical properties of SiZer are based. In contrast to this, our proof strategy does not even require the statistic $\widehat{\Psi}_T$ to have a weak limit and is thus not restricted by the limitations of classic weak convergence theory. 

\item There are different ways to combine the test statistics $S_T(h) = \max_{u \in I} |s_T(u,h)|$ for different scales $h \in H$. One way is to take their maximum, which leads to the SiZer statistic $S_T = \max_{h \in H} S_T(h)$. We could proceed analogously and consider the multiscale statistic $\widehat{\Psi}_{T,\text{uncorrected}} = \max_{h \in H} \widehat{\Psi}_T(h) = \max_{(u,h) \in I \times H} |\widehat{\psi}_T(u,h)/\widehat{\sigma}|$. However, as argued in \cite{DuembgenSpokoiny2001} and as discussed in Section ?? of our paper, this aggregation scheme is not optimal when the set $H = H_T$ contains scales $h$ of many different rates. Following the lead of \cite{DuembgenSpokoiny2001}, we consider the test statistic $\widehat{\Psi}_T = \max_{(u,h) \in I \times H} \{ |\widehat{\psi}_T(u,h)/\widehat{\sigma}| - \lambda(h) \}$ with the additive correction terms $\lambda(h)$. Hence, even though related, our multiscale test statistic $\widehat{\Psi}_T$ differs from the SiZer statistic $S_T$ in important ways. 

\item The main complication in carrying out both our multiscale test and SiZer is to determine the critical values, that is, the quantiles of the test statistics $\widehat{\Psi}_T$ and $S_T$ under $H_0$. In order to approximate the quantiles, we proceed quite differently than in the SiZer literature. The quantiles of the SiZer statistic $S_T$ can be approximated by those of the weak limit process $S$. Usually, however, the quantiles of $S$ cannot be determined analytically but have to be approximated themselves (e.g.\ by the bootstrap procedures of \cite{ChaudhuriMarron1999, ChaudhuriMarron2000}). Alternatively, the quantiles of $S_T$ can be approximated by procedures based on extreme value theory (as proposed in \cite{HannigMarron2006} and \cite{ParkHannigKang2009}). In our approach, the quantiles of $\widehat{\Psi}_T$ under $H_0$ are approximated by those of a suitably constructed Gaussian analogue of $\widehat{\Psi}_T$. It is far from obvious that this Gaussian approximation is valid when the data are dependent. To see this, deep strong approximation theory for dependent data (as derived in \cite{BerkesLiuWu2014}) is needed. It is important to note that our Gaussian approximation procedure is not the same as the bootstrap procedures proposed in \cite{ChaudhuriMarron1999, ChaudhuriMarron2000}. Both procedures can of course be regarded as resampling methods. However, the resampling is done in a quite different way in our case.

\end{enumerate}
We hope the above points make clear that the methodological and theoretical contributions of our paper are quite substantial relative to the SiZer methodology. 
\vspace{10pt}


\textbf{Simulations and applications.} We have thoroughly revised the simulation study in Section ??. In particular, we have re-designed large parts of the comparison study with SiZer according to the suggestions of Referee 2. Moreover, we have analyzed our multiscale test for the case of strongly autocorrelated errors (in particular for AR($1$) errors with parameter $\pm 0.9$) as suggested by Referee 1. Note that we have skipped the simulation scenario which mimics the situation in the application section in order to keep the simulation study to a reasonable length. Finally, we have added a second application example to global temeprature data as requested by Referee 1. 


%Old version: 

%\textbf{Comparison to SiZer.} As requested by the Associate Editor, we give a clear account of the main contributions and innovations of our paper relative to the SiZer approach in the revision. Please see the new Section ?? for the details. In what follows, we summarize the main points of the new Section ??. 

%Informally speaking, both our approach and SiZer (for time series) are methods to test for local increases/decreases of a nonparametric trend function $m$. The formal problem is to test the hypothesis
%\[ H_0(u,h): \text{The trend } m \text{ is constant on the time interval } [u-h,u+h] \]
%simultaneously for a large number of different time intervals $[u-h,u+h]$, in particular, for all intervals with $u \in I$ and $h \in H$, where $I$ is the set of locations and $H$ the set of bandwidths or scales $H$ under consideration. 

%There are two versions of SiZer, a global and a row-wise one. We first discuss the global version as it is closer in spirit to our approach. We comment on the row-wise version later on. The test statistic of the global SiZer approach has the form $S_T = \max_{h \in H} S_T(h)$, where $S_T(h) = \max_{u \in I} |s_T(u,h)|$ for each scale $h$ and $s_T(u,h)$ is a test statistic for $H_0(u,h)$. As shown in \cite{ChaudhuriMarron2000} for the i.i.d.\ case and in \cite{ParkHannigKang2009} for the dependent data case, $S_T$ weakly converges to some limit process $S$ under the overall null hypothesis $H_0$ that $H_0(u,h)$ is fulfilled for all $u \in I$ and $h \in H$. Using this result, one can take the $(1-\alpha)$-quantile of $S$ as a critical value of the SiZer test. (As this quantile can usually not be determined analytically, it has to be approximated, for example, by the bootstrap procedures of \cite{ChaudhuriMarron2000} or the extreme value theory based procedure of \cite{HannigMarron2006}.)

%Even though related, our methods and theory are very different from those in the SiZer literature:
%\begin{itemize}[leftmargin=0.5cm]

%\item Theory for SiZer is derived under the assumption that $H$ is a compact subset of $(0,1)$. As already pointed out in \cite{ChaudhuriMarron2000}, this is a quite severe/substantial restriction: Only bandwidths $h$ are taken into account that remain bounded away from zero as the sample size $T$ grows. Bandwidths $h$ that converge to zero as $T$ increases are excluded. As \cite{ChaudhuriMarron2000} put it (p.420):
%\vspace{0.15cm}

%\begin{spacing}{1.0}
%{\small \textit{Note that all the weak convergence results in this section have been established under the assumption that both $H$ and $I$ are fixed compact subintervals of $(0,\infty)$ and $(-\infty,\infty)$ respectively. Compactness of the set $H \times I$ enables us to exploit standard results on weak convergence of a sequence of probability measures on a space of continuous functions defined on a common compact metric space. However, conventional asymptotics for nonparametric curve estimates allows the smoothing parameter $h$ to shrink with growing sample size. There frequently one assumes that $h_n$ is of the order $n^{-\gamma}$ for some appropriate choice of $0 < \gamma < 1$ so that the estimate $\hat{f}_{h_n}(x)$ converges to the ``true function'' $f(x)$ at an ``optimal rate''. This makes one wonder about the asymptotic behaviour of the empirical scale space surface when $h$ varies in $H_n = [a n^{-\gamma},b]$, where $a,b > 0$ are fixed constants. Extension of our weak convergence results along that direction will be quite interesting, and we leave it as a challenging open problem here.} }
%\end{spacing} 
%\vspace{0.2cm}

%The theory of our paper allows to deal with this problem. In particular, it allows to simultaneously consider scales $h$ that remain bounded away from zero and scales $h = h_T$ that converge to zero at various different rates $T^{-\gamma}$. In order to achieve this, we come up with a proof strategy which is very different from that in the SiZer literature: Whereas \cite{ChaudhuriMarron2000} show that the SiZer statistic $S_T$ weakly converges to a limit process $S$, our proof technique does not even require our test statistic to have a weak limit and is thus not restricted by the limitations of classic weak convergence theory. 

%\item There are different ways to combine the test statistics $S_T(h) = \max_{u \in I} |s_T(u,h)|$ for different scales $h \in H$. One way is to take their maximum, which leads to the SiZer statistic $S_T = \max_{h \in H} S_T(h)$. As argued in \cite{DuembgenSpokoiny2001}, this aggregation scheme is not optimal when the set $H = H_T$ contains scales $h$ of many different orders $T^{-\gamma}$ with $\gamma \in [0,c]$ for some $c > 0$. Following their lead, we consider a test statistic of the form $M_T = \max_{h \in H} \{ M_T(h) - \lambda(h) \}$ with appropriate additive correction terms $\lambda(h)$. Here, $M_T(h) = \max_{u \in I} |m_T(u,h)|$ and $m_T(u,h)$ is a test statistic for $H_0(u,h)$ which is somewhat different but closely related to $s_T(u,h)$. Deriving distribution theory for the statistic $M_T$ is highly non-trivial. In particular, no theory for nonparametric regression models under general dependence conditions has been available so far. The main technical contribution of our paper is to derive such a theory. %In our paper, we provide such a theory. 

%\item The main complication in carrying out our multiscale test and SiZer is to determine the critical values, that is, the quantiles of the test statistics under the null. Our theoretical results show that the $(1-\alpha)$-quantile of the multiscale statistic $M_T$ under the null can be approximated by the $(1-\alpha)$-quantile of a Gaussian version of $M_T$ that can be computed by simulation. It is far from obvious that this approximation is valid. To see this, deep strong approximation theory for dependent data (as derived in \cite{BerkesLiuWu2014}) is needed. Importantly, our simulation-based procedure is not the same as the bootstrap procedures proposed in \cite{ChaudhuriMarron1999, ChaudhuriMarron2000} to compute quantiles of the SiZer statistic. Both procedures are of course resampling methods. However, the resampling is done in a quite different way in our case. 

%\item In practice, SiZer is usually implemented in its row-wise rather than its global form, that is, the test is carried out separately for each scale $h$ based on the statistic $S_T(h) = \max_{u \in I} |s_T(u,h)|$. The main reason for applying the row-wise version of SiZer is to gain some power. However, this gain of power comes at a cost: The row-wise version of SiZer ignores the simultaneous test problem across scales $h$ and thus does not allow to make rigorous simultaneous inference across both locations $u$ and scales $h$. \\
%The aim of our paper is to provide a multiscale test which allows to make rigorous simultaneous inference across locations $u$ and scales $h$ and, at the same time, has as much power as possible. 
%In the new empirical comparison study of Section ??, we examine the size and power properties of our multiscale test and compare it with SiZer. We in particular show that it has better power properties than a more classical multiscale test which is based on the statistic $M_T = \max_{h \in H} M_T(h)$ without additive correction terms. As explained in more detail in Section ??, this more classical multiscale test can be regarded as a version of global SiZer whose critical values are computed by our simulation-based procedure.  

%\end{itemize}

%We hope this summary shows that the methodological and theoretical contributions of our paper are quite substantial relative to the SiZer methodology. As already mentioned above, more details are provided in the new Section ??.


 
\newpage
\begin{center}
{\large \bf Reply to Referee 1} 
\end{center}


Thank you very much for the constructive and helpful comments. In our revision, we have addressed all of them. Please see our replies to your comments below.


\begin{enumerate}[label=(\arabic*),leftmargin=0.8cm]

\item \textit{A consistency result of Proposition 3.3.}

\textit{I believe that the following type of result can be obtained: $\mathbb{P} (E^{\ell}_T) \to 1$. Theorem 3.1 is for testing purpose. In certain application one might be interested in such consistency result. Basically one needs to study the behavior of $q_T(\alpha)$ when $\alpha \to 0$.}

Under our regularity conditions, it can indeed be proven that $\mathbb{P} (E^{\ell}_T) \to 1$ as $\alpha=\alpha_T \rightarrow 1$. We have added this consistency result as Corollary ?? to the paper. The proof is provided in the Supplementary Material.


\item \textit{Estimation of long run variance using autoregressive processes.}

\textit{The authors considered estimating $\sigma^2$ using AR processes. A limitation is that the order $p$ is fixed and finite. It appears that the latter limitation can be relaxed. For a stationary process $\varepsilon_t$ (not necessarily linear), one can fit an AR process with large $p$}
\[ \varepsilon_t = \sum_{j=1}^p a_j \varepsilon_{t-j} + \eta_t, \]
\textit{properties of fitted $\widehat{a}_1, \ldots, \widehat{a}_p$ can be obtained from the results in the following papers: \cite{WuPourahmadi2009} and \cite{XiaoWu2012}.
%\begin{itemize}
%\item W. B. Wu and Mohsen Pourahmadi (2009): Banding Sample Covariance Matrices of Stationary Processes, Statistica Sinica 19 1755-1768.
%\item H. Xiao and W. B. Wu (2012). Covariance Matrix Estimation for Stationary Time Series. Annals of Statistics, Volume 40, Number 1 (2012), 466-493.
%\end{itemize}
A similar version of the authors' estimate (4.14) can be used. Rate of convergence (cf.\ Proposition 4.1) can be derived with rate $T^{-1/2}$ therein possibly replaced by a larger term of the form $T^{-c}$ with $c < 1/2$.}

Many thanks for this interesting suggestion. We have generalized our procedure for estimating the long-run variance $\sigma^2$ along the lines suggested by you: Rather than considering AR($p$) processes of known finite order $p$, we consider the much more general case of AR($\infty$) processes. We thus assume the error process $\{\varepsilon_t\}$ to have the form
\begin{equation}\label{AR-inf}
\varepsilon_t = \sum\limits_{j=1}^\infty a_j \varepsilon_{t-j} + \eta_t, \tag{$*$} 
\end{equation}
where $a_1,a_2,a_3,\ldots$ are unknown parameters and $\eta_t$ are i.i.d.\ innovations (which fulfill certain regularity conditions as detailed in the revised Section 4). Notably, the model \eqref{AR-inf} for the error terms nests AR($p^*$) processes of any finite (unknown) order $p^*$ as a special case: If $a_{p^*} = 0$ and $a_j = 0$ for all $j > p^*$, then $\{ \varepsilon_t \}$ is an AR process of order $p^*$. 

In order to generalize our theory to the case that $\{\varepsilon_t\}$ has an AR($\infty$) representation of the form \eqref{AR-inf}, we proceed as follows: We fit AR($p$) processes to the data whose order $p=p_T$ grows with the sample size $T$. We thus approximate the AR($\infty$) process $\{\varepsilon_t\}$ by a sequence of AR($p$) processes whose order $p=p_T$ goes to infinity. This is somewhat different but related to the banding techniques developed in \cite{WuPourahmadi2009} and \cite{XiaoWu2012}. As you mention yourself in your comment, the resulting estimators are not $\sqrt{T}$-consistent any more. Their convergence rate is somewhat slower than $1/\sqrt{T}$, in particular, it is of the form $p^c/\sqrt{T}$ with some $c > 0$. Please see the revised Proposition 4.1 and its proof in the Supplementary Material for the details. 


\item \textit{Real data application.}

\textit{The authors analyzed the yearly mean Central England temperature data. It will be interesting to apply their approach to the global temperature data. In the paper \cite{WuWoodroofeMentz2001}, an increasing trend function is fitted. It will be important to know which period the sequence in increasing/decreasing.}


\item \textit{Simulation Study.}

\textit{In the simulation study, the authors considered AR(1) processes with relatively weaker dependence: $a_1 \in \{-0.5, -0.25, 0.25, 0.5\}$. One should consider the \linebreak stronger positive/negative dependence case with $a = \pm 0.9$ (say). How does the strength of dependence affect the performance of the procedure?}

We have added the AR($1$) case with $a = \pm 0.9$ to our revised simulation study in Section ??. In particular, we have carried out additional size simulations for the case that $a = \pm 0.9$. The results are reported in Table 2 on p.?? and can be summarized as follows: For the negative parameter $a = -0.9$, the size of the multiscale test is close to the nominal target $\alpha$ for sample sizes $T \ge 1000$. However, for the smaller sample sizes $T=250$ and $T=500$ there are substantial size distortions. In the case of $a = 0.9$, a similar picture arises, however, with somewhat smaller size distortions. Hence, when the error terms are strongly (positively or negatively) autocorrelated, our test method has good size properties only for sufficiently large sample sizes. In our opinion, this is not so surprising: Statistical inference in the presence of strongly autocorrelated data is a very difficult problem in general and satisfying results can only be expected for sufficiently large sample sizes.

\end{enumerate}



\newpage
\begin{center}
{\large \bf Reply to Referee 2} 
\end{center}


Thank you very much for the constructive and useful suggestions. In our revision, we have addressed all of them. In particular, we have thoroughly revised the simulation study which compares our multiscale test with SiZer according to your suggestions. Here are our point-by-point responses to your comments. 


\begin{enumerate}[label=(\arabic*),leftmargin=0.8cm]

\item \textit{Section 3.2: The authors recommend computing the quantiles for the independent Gaussian case by simulation. This suggestion is already in the original SiZer paper \citep{ChaudhuriMarron1999}. However in the late 1990s computing power was not sufficient to make this suggestion feasible. This led to the use of approximation such as in \cite{HannigMarron2006}. I would like to ask how does the simulation based quantile compare to the approximation in \cite{HannigMarron2006}.} 

In the revised simulation study of Section ??, we consider a row-wise version $\mathcal{T}_{\text{RW}}$ of our multiscale test, which is the direct counterpart to the row-wise dependent SiZer method $\mathcal{T}_{\text{SiZer}}$ developed in \cite{Rondonotti2004}, \cite{Rondonotti2007} and \cite{ParkHannigKang2009}. The quantiles of $\mathcal{T}_{\text{RW}}$ under the null are approximated by our simulation-based procedure, whereas the quantiles of $\mathcal{T}_{\text{SiZer}}$ are approximated by the method of \cite{HannigMarron2006} and \cite{ParkHannigKang2009} which is based on extreme value theory. In our simulation study, we compare the size and power properties of $\mathcal{T}_{\text{RW}}$ and $\mathcal{T}_{\text{SiZer}}$. This shows how our simulation-based procedure compares to the approximation in \cite{HannigMarron2006} and \cite{ParkHannigKang2009}.


At this point, we would like to add two remarks on our simulation-based procedure to compute the quantiles of the multiscale test under the null: 
\begin{itemize}[leftmargin=0.5cm]
\item As already mentioned when summarizing the main differences between our multiscale approach and SiZer at the beginning of this letter, the Gaussian approximation procedure that we use for simulating the quantiles of the multiscale statistic under the null is not the same as the bootstrap procedures proposed in \cite{ChaudhuriMarron1999, ChaudhuriMarron2000}. Both procedures are of course resampling methods. However,the resampling is done in a quite different way. 
\item It far from clear that our simulation-based procedure is theoretically valid and provides an adequate critical value such that our test has asymptotically the correct size under the null. One of the main theoretical contributions of the paper is that this is indeed the case. 
\end{itemize}


%compare the size and power properties of the following versions of our multiscale test and SiZer: 
%\begin{itemize}[leftmargin=1.5cm,itemsep=0cm]

%\item[$\mathcal{T}_{\text{MS}}$:] our multiscale test as defined in Section ?? of the paper. 

%\item[$\mathcal{T}_{\text{UC}}$:] an uncorrected version of our multiscale test without the additive correction terms $\lambda(h)$ 

%\item[$\mathcal{T}_{\text{RW}}$:] a row-wise version of our multiscale test 

%\item[$\mathcal{T}_{\text{SiZer}}$:] the row-wise version of dependent SiZer as developed in \cite{Rondonotti2004}, \cite{Rondonotti2007} and \cite{ParkHannigKang2009}. 

%\end{itemize}
%The row-wise version $\mathcal{T}_{\text{RW}}$ of our test is the direct counterpart to the sizer test $\mathcal{T}_{\text{SiZer}}$. The two main differences of the two procedures are as follows: (i) $\mathcal{T}_{\text{RW}}$ and $\mathcal{T}_{\text{SiZer}}$ are based on different statistics to test the hypotheses $H_0(u,h)$ that $m$ is constant on the interval $[u-h,u+h]$. (ii) The quantiles of $\mathcal{T}_{\text{RW}}$ under the null are approximated by our simulation-based procedure, whereas the quantiles of $\mathcal{T}_{\text{SiZer}}$ are approximated by the method of \cite{HannigMarron2006} and \cite{ParkHannigKang2009} which is based on extreme value theory. In our simulation study, we in particular compare the size and power properties of $\mathcal{T}_{\text{RW}}$ and $\mathcal{T}_{\text{SiZer}}$. This shows how our simulation-based procedure compares to the approximation in \cite{HannigMarron2006} and \cite{ParkHannigKang2009}.


%-- Compare multiscale test with and without additive correction terms $\lambda(h)$ by ``parallel coordinate plots'' as in Figure 5 of Hannig \& Marron (2006). 


\item \textit{Page 12, line 15: What is random here? After a spending some time I believe that it is the $\Pi_T$ but on first reading I thought $E_T$s are non-random. Please explain these various objects better.}

We have rewritten the text concerning the objects $\Pi_T^\ell$ and $E_T^\ell$ for $\ell \in \{\pm,+,-\}$ as suggested. We have in particular attempted to explain these objects in a clearer way and to clarify the question what is random here. (The collection of intervals $\Pi_T^\ell$ is indeed random.) Please see p.?? for the details. We hope the new exposition of the material makes things clearer.  


\item \textit{Page 18, line 52: Please remove the speculative statements about what can be shown unless you actually show it in this paper.}

We have removed the speculative statements following Proposition 4.1.


\item \textit{Section 4.1: This section does not contain any truly new material and should be removed.}

We have removed Section 4.1 from the paper. Moreover, we have thoroughly revised Section 4 on the estimation of the long-run error variance according to the suggestions of Referee 1. Please see our reply to comment (2) of Referee 1 for the details. 


\item \textit{Section 5.2: I understand that you are doing comparisons to SiZer out of the box. However, some of the comparison might not be quite fair. SiZer is adjusting multiplicity ”row-wise” while the proposed method is attempting a global multiple control. What would happen if your $G_T$ only focused on one scale?}

We have thoroughly revised the comparison study with SiZer, attempting to give a better and fairer picture of the methods. The revised study compares the following versions of our multiscale test and SiZer: 
\begin{itemize}[leftmargin=0.5cm,itemsep=0cm]

\item our multiscale test $\mathcal{T}_{\text{MS}}$ as defined in Section ?? of the paper 
\item an uncorrected version $\mathcal{T}_{\text{UC}}$ of our multiscale test without the additive correction terms $\lambda(h)$ 
\item a row-wise version of $\mathcal{T}_{\text{RW}}$ of our multiscale test 
\item the row-wise dependent SiZer $\mathcal{T}_{\text{SiZer}}$ of \cite{Rondonotti2004}, \cite{Rondonotti2007} and \cite{ParkHannigKang2009}. 

\end{itemize}
We have analyzed the size and power properties of the four methods (not only the global but also the row-wise size and power properties to be fairer with regard to SiZer). As already mentioned in our answer to your comment (1), the row-wise version $\mathcal{T}_{\text{RW}}$ of our multiscale test focuses on one scale at a time and is thus the direct counterpart to $\mathcal{T}_{\text{SiZer}}$. Please see Section ?? for the full simulation study, which in particular shows how $\mathcal{T}_{\text{RW}}$ and $\mathcal{T}_{\text{SiZer}}$ compare to each other. We hope you find the revised study more accurate.


%What's done (here $\alpha$ is always taken to be $0.05$):
%\begin{itemize}
%\item For each setting, each sample size, and each bandwidth row we report the percentage of realizations of the data in which there were some red or blue pixels in that row. The reports are given in ``parallel coordinate plots'' as in Figure 5 of \cite*{HannigMarron2006}. Each plot has the results of SiZer, the results of our global method and the results of our rowwise method respectively. The settings are as follows:
%\begin{enumerate}
%\item Under the null for $a_1 = -0.25, 0, 0.25$ and sample size $T = 250$.
%\item Under the alternative for $a_1 = -0.25, 0$ and sample size $T = 250$. The trend function is linear increasing on the whole interval with the slope $\beta = 1.25$. 
%\item Under the alternative for $a_1 = 0.25$ and sample size $T = 250$. The trend function is linear increasing on the whole interval with the slope $\beta = 2.25$. 
%\end{enumerate}
%\item Representative SiZer maps (for SiZer, our global method and our rowwise method) for simulated data from the null distribution for $a_1 = -0.25, 0, 0.25$. Sample size is $T = 250$. $1,000$ such SiZer maps were simulated for each setting and the population of them was ordered in terms of number of pixels that flag significant structure by being red or blue. For each setting and for each method we show 500th of these maps (essentially the median of the population), the 750th (the third quartile), the 850th and the 950th member of the ordered population.
%\end{itemize}


\item \textit{Page 25, line 1-26: I do not quite understand this figure. Would it be possible to rather reproduce the colorful SiZer figures that show the results of the test at various scales and locations? Also you should use several different signals. I believe that a single relatively large bump is not sufficient test bed. A good collection of signals can be found in \cite{DonohoJohnstone1995}. Also, would \cite{HannigLeePark2013} be helpful in comparing the results?}

%What's done (here $\alpha$ is always taken to be $0.05$):
%\begin{itemize}
%\item Plots comparing SiZer maps under the null:
%\begin{enumerate}
%\item Plots comparing SiZer and global method and rowwise methods respectively for sample size is $T=250$. AR(1) parameters are $a_1 = -0.25, 0, 0.25$ and $\sigma_\eta^2 = 1$.
%\end{enumerate}
%\item Plots comparing SiZer maps under the alternative:
%\begin{enumerate}
%\item Plots comparing SiZer and global method and rowwise methods respectively for sine curve plus AR(1) noise (as in \cite*{ParkHannigKang2009}) for sample size $T=250$. AR(1) parameters are $a_1 = -0.25, 0, 0.25$ and $\sigma_\eta^2 = 1$.
%\item Plots comparing SiZer and global method and rowwise methods respectively for blocks plus AR(1) noise (signal from \cite*{Donoho1995}, recentered and normalized as in \cite*{HannigMarron2006}) for sample size $T=250$. AR(1) parameters are $a_1 = -0.25, 0, 0.25$ and $\sigma_\eta^2 = 0.01$.
%\item Plots comparing SiZer and global method and rowwise methods respectively for blocks plus AR(1) noise (signal from \cite*{Donoho1995}, recentered and normalized as in \cite*{HannigMarron2006}) for sample size $T=1000$. AR(1) parameters are $a_1 = -0.25, 0, 0.25$ and $\sigma_\eta^2 = 0.01$.
%\end{enumerate}
%\end{itemize}

%Different signals: \\
%-- Power results could be reported in terms of ability to find the jump points in the blocks example. 


\item \textit{Page 31, line 1-39: Can you plot the SiZer results on this data?}

\end{enumerate}



%\begin{figure}[t!]
%\begin{subfigure}[b]{0.475\textwidth}
%\includegraphics[width=\textwidth]{Plots/rowwise_sig_comparison_T_250_a1_-50_slope_0.pdf}
%\caption{$a_1 = -0.5$, slope = $0$}
%\end{subfigure}\hspace{0.25cm}
%\begin{subfigure}[b]{0.475\textwidth}
%\includegraphics[width=\textwidth]{Plots/rowwise_sig_comparison_T_250_a1_-50_slope_125.pdf}
%\caption{$a_1 = -0.5$, slope = $1,25$}
%\end{subfigure}\\
%\begin{subfigure}[b]{0.475\textwidth}
%\includegraphics[width=\textwidth]{Plots/rowwise_sig_comparison_T_250_a1_-25_slope_0.pdf}
%\caption{$a_1 = -0.25$, slope = $0$}
%\end{subfigure}\hspace{0.25cm}
%\begin{subfigure}[b]{0.475\textwidth}
%\includegraphics[width=\textwidth]{Plots/rowwise_sig_comparison_T_250_a1_-25_slope_125.pdf}
%\caption{$a_1 = -0.25$, slope = $1.25$}
%\end{subfigure}\\
%\begin{subfigure}[b]{0.475\textwidth}
%\includegraphics[width=\textwidth]{Plots/rowwise_sig_comparison_T_250_a1_0_slope_0.pdf}
%\caption{$a_1 = 0$, slope = $0$}
%\end{subfigure}\hspace{0.25cm}
%\begin{subfigure}[b]{0.475\textwidth}
%\includegraphics[width=\textwidth]{Plots/rowwise_sig_comparison_T_250_a1_0_slope_125.pdf}
%\caption{$a_1 = 0$, slope = $1.25$}
%\end{subfigure}
%\caption{Parallel coordinate plots for $T = 250$ and different AR(1) parameters $a_1 = -0.5, -0.25, 0, 0.25$ in the simulation scenarios with a pronounced trend and without the trend respectively.}\label{fig:PCP}
%\end{figure}

%\begin{figure}[t]
%    \ContinuedFloat
%\begin{subfigure}[b]{0.475\textwidth}
%\includegraphics[width=\textwidth]{Plots/rowwise_sig_comparison_T_250_a1_25_slope_0.pdf}
%\caption{$a_1 = 0.25$, slope = $0$}
%\end{subfigure}\hspace{0.25cm}
%\begin{subfigure}[b]{0.475\textwidth}
%\includegraphics[width=\textwidth]{Plots/rowwise_sig_comparison_T_250_a1_25_slope_225.pdf}
%\caption{$a_1 = 0.25$, slope = $2.25$}
%\end{subfigure}
%\caption{Parallel coordinate plots for $T = 250$ and different AR(1) parameters $a_1 = -0.5, -0.25, 0, 0.25$ in the simulation scenarios with a pronounced trend and without the trend respectively.}\label{fig:PCP}
%\end{figure}

%\begin{figure}[t!]
%\begin{subfigure}[b]{0.475\textwidth}
%\includegraphics[width=\textwidth]{Plots/representatives_T_250_a1_-50_slope_0.pdf}
%\caption{$a_1 = -0.5$}
%\end{subfigure}\hspace{0.25cm}
%\begin{subfigure}[b]{0.475\textwidth}
%\includegraphics[width=\textwidth]{Plots/representatives_T_250_a1_-25_slope_0.pdf}
%\caption{$a_1 = -0.25$}
%\end{subfigure}\\
%\begin{subfigure}[b]{0.475\textwidth}
%\includegraphics[width=\textwidth]{Plots/representatives_T_250_a1_0_slope_0.pdf}
%\caption{$a_1 = 0$}
%\end{subfigure}\hspace{0.25cm}
%\begin{subfigure}[b]{0.475\textwidth}
%\includegraphics[width=\textwidth]{Plots/representatives_T_250_a1_25_slope_0.pdf}
%\caption{$a_1 = 0.25$}
%\end{subfigure}
%\caption{Representative SiZer maps $T = 250$ and different AR(1) parameters $a_1 = -0.5, -0.25, 0, 0.25$ in the simulation scenario under the null.}\label{fig:Representative_SiZer_maps}
%\end{figure}

%\begin{figure}[t!]
%\begin{subfigure}[b]{0.475\textwidth}
%\includegraphics[width=\textwidth]{Plots/SiZer_comparison_under_null_global_T_250.pdf}
%\caption{Global method}
%\end{subfigure}\hspace{0.25cm}
%\begin{subfigure}[b]{0.475\textwidth}
%\includegraphics[width=\textwidth]{Plots/SiZer_comparison_under_null_rowwise_T_250.pdf}
%\caption{Rowwise method}
%\end{subfigure}
%\caption{Comparative SiZer maps for $T = 250$ and different AR(1) parameters $a_1 = -0.25, 0, 0.25$ in the simulation scenario under the null}\label{fig:SiZer_maps_comparison_null}
%\end{figure}

%\begin{figure}[t!]
%\begin{subfigure}[b]{0.475\textwidth}
%\includegraphics[width=\textwidth]{Plots/SiZer_comparison_sin_global_T_250.pdf}
%\caption{Global method}
%\end{subfigure}\hspace{0.25cm}
%\begin{subfigure}[b]{0.475\textwidth}
%\includegraphics[width=\textwidth]{Plots/SiZer_comparison_sin_rowwise_T_250.pdf}
%\caption{Rowwise method}
%\end{subfigure}
%\caption{Comparative SiZer maps for $T = 250$ and different AR(1) parameters $a_1 = -0.25, 0, 0.25$ in the simulation scenario with sine curve as the trend function}\label{fig:SiZer_maps_comparison_null}
%\end{figure}

%\begin{figure}[t!]
%\begin{subfigure}[b]{0.475\textwidth}
%\includegraphics[width=\textwidth]{Plots/SiZer_comparison_blocks_global_T_1000.pdf}
%\caption{Global method}
%\end{subfigure}\hspace{0.25cm}
%\begin{subfigure}[b]{0.475\textwidth}
%\includegraphics[width=\textwidth]{Plots/SiZer_comparison_blocks_rowwise_T_1000.pdf}
%\caption{Rowwise method}
%\end{subfigure}
%\caption{Comparative SiZer maps for $T = 1000$ and different AR(1) parameters $a_1 = -0.25, 0, 0.25$ in the simulation scenario with blocks as the trends function}\label{fig:SiZer_maps_comparison_blocks}
%\end{figure}



\newpage
\bibliographystyle{ims}
{\small
\setlength{\bibsep}{0.55em}
\bibliography{bibliography}}



\end{document}
