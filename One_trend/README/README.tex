\documentclass[a4paper,12pt]{article}
\usepackage{amsmath}
\usepackage{amssymb,amsthm,graphicx}
\usepackage{enumitem}
\usepackage{color}
\usepackage{epsfig}
\usepackage{graphics}
\usepackage{pdfpages}
\usepackage{subcaption}
\usepackage[font=small]{caption}
\usepackage[hang,flushmargin]{footmisc} 
\usepackage{float}
\usepackage{booktabs}
\usepackage[mathscr]{euscript}
\usepackage{natbib}
\usepackage{setspace}
\usepackage{mathrsfs}
\usepackage[Q=yes]{examplep}
\usepackage[T1]{fontenc}
%\usepackage{hanging}
\usepackage[left=3cm,right=3cm,bottom=3cm,top=3cm]{geometry}
\renewcommand{\baselinestretch}{1.05}\normalsize
\parindent0pt




\begin{document}



\begin{center}
{\LARGE \bf Code documentation}
\end{center}
\vspace{0.5cm}



\section*{Summary}


\setlength{\parskip}{0.2cm} 
This document describes the R code that can be used to replicate the empirical results reported in the paper \textit{Multiscale Inference and Long-Run Variance Estimation in Nonparametric Regression with Time Series Errors}. The overall structure of the code is as follows. There are four main files each of which produces a specific part of the simulations and applications:
\vspace{0.2cm}

\everypar{\hangafter=1\hangindent=1.45cm\relax}
\verb|main_shape_simulation.R| \hspace{1pt} produces the simulation results for our multiscale method, that are reported in Section 5.1.

\verb|main_shape_comparison.R| \hspace{1pt} produces the simulation results on comparison between our multiscale test and SiZer, that we report in Section 5.2.

\verb|main_variance_simulation.R| \hspace{1pt} produces the simulation results for our long-run variance estimator and its comparison with the estimator from Hall and Van Keilegom (2003) and the oracle one. These results are presented in Section 5.3.

\verb|main_shape_application.R| \hspace{1pt} produces the application results from Section 6, where our multsicale test of the hypothesis $H_0: m^\prime = 0$ is applied.


\everypar{\hangafter=0\relax}
These main files read in a number of functions which are collected in the folder \verb|Shape|. The simulation and application results are stored either as figures or as \verb|.tex| files (for tables) in the folder \verb|Plots|. 
\vspace{0.2cm}


All programs are written in R with some functions in C. They are all quite self-explanatory and commented. The code is self-sufficient, the only thing that is OS-specific and may need to be changed is the extension of dynamic libraries. Dynamic libraries are defined in the beginning of each main file. At the moment everything is configured for running on Windows, that is, the \verb|.dll| extension is used. In order to make the programs Linux or MacOS compatible, this extension should be changed to \verb|.so|. For example, the file
\begin{verbatim}
dyn.load("Shape/C_code/estimating_sigma.dll")
\end{verbatim} should be replaced by
\begin{verbatim}
dyn.load("Shape/C_code/estimating_sigma.so").
\end{verbatim}
All the dynamic libraries are already provided, additional  compilation is not necessary.



\newpage
\section*{Description of the files provided}


\setlength{\parskip}{0.3cm}
\everypar{\hangafter=1\hangindent=1.45cm\relax}

\verb|main_shape_simulation.R| \hspace{1pt} produces the simulation results for the test method from Section 4, in particular Tables 1 and 2 in Section 7. If you use Linux or MacOS, please change the extension of dynamic libraries in the very beginning of the main file to \verb|.so|. The size and power results in Tables 1 and 2 are calculated from $1000$ simulated samples. This number can be set as \verb|N| in \verb|main_shape_simulation.R|. The running time for $1000$ simulations is quite small, amounting to a few minutes. 

\verb|main_shape_application.R| \hspace{1pt} produces the application results from Section 8.1, in particular Figure 1. As above, please change the extension of dynamic libraries if you use Linux or MacOS.

\verb|Shape| \hspace{1pt} is a directory that contains all the necessary functions, data and simulated distributions to run the two main files \verb|main_shape_simulation.R| and \verb|main_shape_application.R|.

\verb|Shape\C_code| \hspace{1pt} is a folder that contains the dynamic libraries and R-wrappers of the C functions.

\verb|Shape\functions.R| \hspace{1pt} is a file that consists of auxiliary R functions.

\verb|Shape\data| \hspace{1pt} is a folder with the file \verb|cetml1659on.dat| which contains the monthly and yearly mean central England temperature from 1659 up to 2017. It was downloaded from \verb|https://www.metoffice.gov.uk/hadobs/hadcet/data| \verb|/download.html|. A full description of the data can be accessed on the website of the UK Met Office \verb|https://www.metoffice.gov.uk|. 

\verb|Shape\distribution| \hspace{1pt} is a folder that  contains simulated distributions of the Gaussian statistic $\Phi'_{T}$ for various time series lengths $T$. In order to recalculate these distributions, the stored files need to be deleted or removed; the computation is then done automatically while running the main file. The distribution of the Gaussian statistic $\Phi'_T$ used to calculate the critical values of the test in the application in Section 8.1 is stored in the file \verb|distr_T_359_testing_constant_type_ll.RData|. As before, the distribution of $\Phi'_T$ can be recalculated by removing or deleting this file before running \verb|main_shape_application.R|.  
\vspace{0.2cm}

\end{document}
